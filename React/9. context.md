# Context。待分析拆解筆記

- 在context裡面增加一個zipCode
- src/context/zipCode.js

## step 1. React.createContext
- 利用 `React.createContext` 創造一個 `ZipCodeContext`，並給定初始值

## step 2. useContextValue
- 設定context裡面要有什麼值
- 寫成hooks的形式


```jsx
import React, { useState } from 'react';
import { useRequest } from '@umijs/hooks';
import { getCommonZipCode } from '@/services/common';

const ZipCodeContext = React.createContext({
  zipCode: {},
});

const useZipCodeContextValue = () => {
  const [data, setData] = useState({});
  const { data: zipCodeData } = useRequest(getCommonZipCode, {
    onSuccess: () => setData(zipCodeData?.info?.info),
  });

  const zipCodeValue = {
    zipCode: data,
  };

  return zipCodeValue;
};

ZipCodeContext.displayName = 'ZipCodeContext';

export default ZipCodeContext;
export { useZipCodeContextValue };
```

- 只有加上檔案，測試發現上述檔案並沒有被觸發，所以沒有拿到zipCode
- 發現要加入 `provider` 裡面才行
- src/providers.js

```jsx
// Init zipCode
  const zipCodeContextValue = useZipCodeContextValue();

return (
    <HelmetProvider>
      <ViewContext.Provider value={viewContextValue}>
        <SiteContext.Provider value={siteContextValue}>
          <LoginContext.Provider value={loginContextValue}>
            <CartContext.Provider value={cartContextValue}>
              <ZipCodeContext.Provider value={zipCodeContextValue}>
                {!loading && !error && (
                  <>
                    <GlobalStyle {...siteContextValue.layoutSetting.setting} />
                    {children}
                  </>
                )}
                {error && <Content500 />}
              </ZipCodeContext.Provider>
            </CartContext.Provider>
          </LoginContext.Provider>
        </SiteContext.Provider>
      </ViewContext.Provider>
    </HelmetProvider>
  );
```

# 購物車 context

### 關於createContext的研究，待筆記

- 參考cart購物車的寫法
- 研究context，經由provider，讓下層可以用useContext拿到值。
- 他也可以另外加入customHooks，(購物車)
- 如果要比較單純的用法，參考memberCard 會員卡片
- 但是傳的東西，一定還是只能從child component接收，所以不適用跳轉畫面的情況
- 
